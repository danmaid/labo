import{d as V,r as i,c as m,e as l,w as d,F as f,o as p,x as w,f as _,b as s,h as r,l as u,t as c}from"./vendor.83c679c4.js";import{_ as k,V as C,a as F,S}from"./index.2c62aea5.js";import{T as U}from"./Table.e5b9d727.js";const g=V({components:{ViewSelector:C,ViewItem:F,Table:U,Select:S},data(){return{items:[],columns:[{text:"\u8B58\u5225\u5B50",value:"id"},{text:"\u540D\u79F0",value:"name"},{text:"\u4F4F\u6240",value:"address"},{text:"\u96FB\u8A71\u756A\u53F7",value:"phone_number"},{text:"",value:"actions"}],edits:[],id:void 0,addresses:[]}},computed:{addressesForSelect(){return this.addresses.map(e=>({text:e.name,value:e.id}))}},mounted(){this.refresh()},methods:{async refresh(){this.items=await this.$api.get("/department"),this.addresses=await this.$api.get("/address")},async add(){await this.$api.put(`/department/${this.id}`,{}),this.refresh()},cancel(e){const n=this.edits.indexOf(e);n>=0&&this.edits.splice(n,1)},async save(e,n){await this.$api.put(`/department/${e}`,n),this.cancel(e),this.refresh()},async remove(e){await this.$api.delete(`/department/${e}`),this.refresh()}}}),y=["onUpdate:modelValue"],B=["onUpdate:modelValue"],T=["onUpdate:modelValue"],D=["onClick"],j=["onClick"],A=["href"],N=["href"],z=["onClick"],E=["onClick"],I=s("h1",null,"Department",-1),L=["href"];function M(e,n,O,q,x,G){const v=i("view-selector"),b=i("Select"),$=i("Table"),h=i("view-item");return p(),m(f,null,[l(v,{items:[{name:"table"}]}),l(h,{name:"table"},{default:d(()=>[l($,{columns:e.columns,items:e.items},w({"header.actions":d(()=>[s("button",{onClick:n[0]||(n[0]=(...t)=>e.refresh&&e.refresh(...t))},"refresh")]),"item.phone_number":d(({value:t})=>[s("a",{href:`tel://${t}`,target:"_blank"},c(t),9,A)]),"item.address":d(({value:t})=>[s("a",{href:`/address/${t}`,target:"_blank"},c(t),9,N)]),"item.actions":d(({item:t})=>[s("button",{onClick:a=>e.edits.push(t.id)},"edit",8,z),s("button",{onClick:a=>e.remove(t.id)},"remove",8,E)]),tfoot:d(()=>[r(s("input",{"onUpdate:modelValue":n[1]||(n[1]=t=>e.id=t)},null,512),[[u,e.id]]),s("button",{onClick:n[2]||(n[2]=(...t)=>e.add&&e.add(...t))},"add")]),_:2},[_(e.edits,t=>({name:`row.${t}`,fn:d(({item:a})=>[s("tr",null,[s("td",null,[r(s("input",{"onUpdate:modelValue":o=>a.id=o},null,8,y),[[u,a.id,void 0,{lazy:!0}]])]),s("td",null,[r(s("input",{"onUpdate:modelValue":o=>a.name=o},null,8,B),[[u,a.name]])]),s("td",null,[l(b,{modelValue:a.address,"onUpdate:modelValue":o=>a.address=o,items:e.addressesForSelect},null,8,["modelValue","onUpdate:modelValue","items"])]),s("td",null,[r(s("input",{"onUpdate:modelValue":o=>a.phone_number=o},null,8,T),[[u,a.phone_number]])]),s("td",null,[s("button",{onClick:o=>e.save(t,a)},"save",8,D),s("button",{onClick:o=>e.cancel(t)},"cancel",8,j)])])])}))]),1032,["columns","items"])]),_:1}),l(h,null,{default:d(()=>[I,(p(!0),m(f,null,_(e.items,t=>(p(),m("div",null,[s("a",{href:`/department/${t.id}`},c(t.name),9,L)]))),256))]),_:1})],64)}var P=k(g,[["render",M]]);export{P as default};
